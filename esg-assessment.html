<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESG Î≥¥Ïïà ÏÑ±ÏàôÎèÑ ÏßÑÎã® ÏÑ§Î¨∏</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 40px;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .form-container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
            font-size: 1.1em;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .question-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
            transition: transform 0.2s ease;
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.1em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .rating-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .rating-option {
            flex: 1;
            min-width: 120px;
        }

        .rating-option input[type="radio"] {
            display: none;
        }

        .rating-option label {
            display: block;
            padding: 12px;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .rating-option input[type="radio"]:checked + label {
            background: #3498db;
            color: white;
            border-color: #2980b9;
            transform: scale(1.05);
        }

        .rating-option label:hover {
            border-color: #3498db;
            background: #ecf0f1;
        }

        .progress-container {
            background: #ecf0f1;
            height: 10px;
            border-radius: 5px;
            margin: 30px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 5px;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #34495e;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            min-width: 200px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .results-container {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        .score-display {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .score-number {
            font-size: 4em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-label {
            font-size: 1.5em;
            opacity: 0.9;
        }

        .chart-container {
            margin: 30px 0;
            min-height: 400px;
        }

        .area-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .area-score-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 5px solid #3498db;
        }

        .area-score-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .area-score-value {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }

        .success-message {
            background: #27ae60;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header, .form-container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .rating-container {
                flex-direction: column;
            }
            
            .rating-option {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê ESG Î≥¥Ïïà ÏÑ±ÏàôÎèÑ ÏßÑÎã®</h1>
            <p>Ï†úÎ°úÌä∏Îü¨Ïä§Ìä∏ Í∏∞Î∞ò Í∏∞ÏóÖ Î≥¥Ïïà ÏÑ±ÏàôÎèÑ ÌèâÍ∞Ä</p>
            <div class="badge">ESG ÌòëÎ†• ÎÑ§Ìä∏ÏõåÌÅ¨ Íµ¨Ï∂ï Î∞è ÏàòÏ∂úÍ∏∞ÏóÖ ÏÑ±Ïû• ÏßÄÏõê AI ÌîåÎû´Ìèº</div>
        </div>

        <div class="form-container">
            <form id="esgForm">
                <!-- Í∏∞ÏóÖ Ï†ïÎ≥¥ ÏÑπÏÖò -->
                <div class="section">
                    <h2>üìã Í∏∞ÏóÖ Ï†ïÎ≥¥</h2>
                    
                    <div class="form-group">
                        <label for="companyName">Í∏∞ÏóÖÎ™Ö *</label>
                        <input type="text" id="companyName" name="companyName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Ïù¥Î©îÏùº Ï£ºÏÜå *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="companySize">Í∏∞ÏóÖ Í∑úÎ™® *</label>
                        <select id="companySize" name="companySize" required>
                            <option value="">ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                            <option value="1">ÏÜåÍ∏∞ÏóÖ (50Î™Ö ÎØ∏Îßå)</option>
                            <option value="2">Ï§ëÏÜåÍ∏∞ÏóÖ (50-299Î™Ö)</option>
                            <option value="3">Ï§ëÍ≤¨Í∏∞ÏóÖ (300-999Î™Ö)</option>
                            <option value="4">ÎåÄÍ∏∞ÏóÖ (1000Î™Ö Ïù¥ÏÉÅ)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="businessType">ÏóÖÌÉú/ÏóÖÏ¢Ö *</label>
                        <select id="businessType" name="businessType" required>
                            <option value="">ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>
                            <option value="1">Í≥†ÏúÑÌóòÍµ∞ (Í∏àÏúµ, ÏùòÎ£å, ÏóêÎÑàÏßÄ, Íµ≠Î∞©)</option>
                            <option value="2">Ï§ëÏúÑÌóòÍµ∞ (IT/ÏÜåÌîÑÌä∏Ïõ®Ïñ¥, Ï†ÑÏûêÌÜµÏã†, ÌôîÌïô)</option>
                            <option value="3">Ï†úÏ°∞ÏóÖÍµ∞ (ÏûêÎèôÏ∞®, Í∏∞Í≥Ñ, ÏÑ¨Ïú†, ÏãùÌíà)</option>
                            <option value="4">ÏÑúÎπÑÏä§Íµ∞ (Ïú†ÌÜµ, Î¨ºÎ•ò, ÍµêÏú°, Ïª®ÏÑ§ÌåÖ)</option>
                            <option value="5">Ï†ÑÌÜµÏóÖÍµ∞ (Í±¥ÏÑ§, Î∂ÄÎèôÏÇ∞, ÎÜçÏóÖ, ÏöîÏãùÏóÖ)</option>
                        </select>
                    </div>
                </div>

                <!-- ÏßÑÌñâÎ•† ÌëúÏãú -->
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">Í∏∞ÏóÖÏ†ïÎ≥¥ ÏûÖÎ†• Ï§ë...</div>

                <!-- Î≥¥Ïïà ÏßÑÎã® ÏßàÎ¨∏ ÏÑπÏÖò -->
                <div class="section" id="questionsSection" style="display: none;">
                    <h2>üîí Î≥¥Ïïà ÏÑ±ÏàôÎèÑ ÏßÑÎã® (24Î¨∏Ìï≠)</h2>
                    <div id="questionsContainer"></div>
                </div>

                <button type="button" class="btn" id="startBtn">ÏßÑÎã® ÏãúÏûë</button>
                <button type="button" class="btn hidden" id="submitBtn">ÏßÑÎã® ÏôÑÎ£å</button>
            </form>

            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>
            <div class="loading" id="loadingMessage" style="display: none;">
                <div class="spinner"></div>
                <p>ÏßÑÎã® Í≤∞Í≥ºÎ•º Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§...</p>
            </div>
        </div>

        <!-- Í≤∞Í≥º ÌëúÏãú ÏòÅÏó≠ -->
        <div class="results-container" id="resultsContainer">
            <h2>üìä ÏßÑÎã® Í≤∞Í≥º</h2>
            <div class="score-display" id="scoreDisplay">
                <div class="score-number" id="overallScore">0.0</div>
                <div class="score-label" id="maturityLevel">Level 1 - Í∏∞Ï°¥(Traditional)</div>
            </div>
            
            <div class="chart-container">
                <div id="radarChart"></div>
            </div>
            
            <div class="area-scores" id="areaScores"></div>
        </div>
    </div>

    <script>
        // ‚úÖ Ïã§Ï†ú Ïõπ Ïï± URLÎ°ú Ïó∞Í≤∞!
        const API_URL = 'https://script.google.com/macros/s/AKfycbyI3i2atkJB7z6BFNdLZp1S_lC6hELTQJ_9Dgiq6QAwbii0rC_yxS6OgVRyYqy8vEjV/exec';
        
        // Î≥¥Ïïà ÏßÑÎã® ÏßàÎ¨∏ Îç∞Ïù¥ÌÑ∞
        const questions = {
            "Ïã†Ïõê": [
                "Ïò®ÌîÑÎ†àÎØ∏Ïä§(ÏÇ¨ÎÇ¥ ÏÑúÎ≤Ñ)ÏôÄ Ïô∏Î∂Ä ÌÅ¥ÎùºÏö∞Îìú ÏÑúÎπÑÏä§Ïùò ID Í¥ÄÎ¶¨Î•º ÌÜµÌï©ÌïòÏó¨ ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "Îã§Îã®Í≥Ñ Ïù∏Ï¶ù(MFA)Î•º ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÏäµÎãàÍπå?", 
                "ÌÅ¥ÎùºÏö∞Îìú Í∏∞Î∞ò Ïù∏Ï¶ù Î∞è FIDO(ÏÉùÏ≤¥Ïù∏Ï¶ù ÌëúÏ§Ä) Í∏∞Î∞ò Ïù∏Ï¶ùÏùÑ ÏßÄÏõêÌï©ÎãàÍπå?",
                "AI Í∏∞Î∞òÏúºÎ°ú ÏúÑÌóòÎèÑÎ•º ÏûêÎèô ÌåêÎã®ÌïòÏó¨ Î≥¥ÏïàÏ†ïÏ±ÖÏùÑ Ï†ÅÏö©Ìï† Ïàò ÏûàÏäµÎãàÍπå?"
            ],
            "Í∏∞Í∏∞ Î∞è ÏóîÎìúÌè¨Ïù∏Ìä∏": [
                "Î™®Îì† Í∏∞Í∏∞(PC, Ïä§ÎßàÌä∏Ìè∞, ÌÉúÎ∏îÎ¶ø Îì±)Ïùò Î≥¥ÏïàÏ†ïÏ±Ö Ï§ÄÏàò Ï†ïÎ≥¥Î•º ÏàòÏßëÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "ÎåÄÎ∂ÄÎ∂ÑÏùò Í∏∞Í∏∞Ïóê Î≥¥ÏïàÏ†ïÏ±ÖÏùÑ ÏûêÎèôÏúºÎ°ú Ï†ÅÏö©ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "Î™®Îì† Í∏∞Í∏∞Ïóê ÎåÄÌï¥ ÏúÑÌòë ÌÉêÏßÄ Î∞è ÏûêÎèô ÎåÄÏùëÏù¥ Í∞ÄÎä•Ìï©ÎãàÍπå?",
                "Í∏∞Í∏∞ Î≥¥ÏïàÏÉÅÌÉúÎ•º Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î™®ÎãàÌÑ∞ÎßÅÌïòÍ≥† ÏûêÎèô Í¥ÄÎ¶¨Í∞Ä Í∞ÄÎä•Ìï©ÎãàÍπå?"
            ],
            "ÎÑ§Ìä∏ÏõåÌÅ¨": [
                "Í≤ΩÍ≥ÑÎ≥¥Ïïà(Î∞©ÌôîÎ≤Ω) Ï§ëÏã¨Ïùò ÎÑ§Ìä∏ÏõåÌÅ¨ÏóêÏÑú Î™®Îì† Ìä∏ÎûòÌîΩ Î™®ÎãàÌÑ∞ÎßÅÏù¥ Í∞ÄÎä•Ìï©ÎãàÍπå?",
                "ÎÇ¥Î∂Ä Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÎì§ Í∞ÑÏùò Ìä∏ÎûòÌîΩÏùÑ ÏÑúÎ°ú Í≤©Î¶¨ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "ÎßàÏù¥ÌÅ¨Î°ú ÏÑ∏Í∑∏Î©òÌÖåÏù¥ÏÖòÏùÑ ÌÜµÌï¥ Í∞Å Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÑ ÎèÖÎ¶ΩÏ†ÅÏúºÎ°ú Î≥¥Ìò∏ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "ÏûêÎèôÌôîÎêú ÎÑ§Ìä∏ÏõåÌÅ¨ Î≥¥Ïïà Ï†ïÏ±Ö Î∞∞Ìè¨ Î∞è Í¥ÄÎ¶¨Í∞Ä Í∞ÄÎä•Ìï©ÎãàÍπå?"
            ],
            "ÏãúÏä§ÌÖú": [
                "ÏãúÏä§ÌÖú Ï†ëÍ∑º Ïãú Îã®ÏàúÌïú ID/Ìå®Ïä§ÏõåÎìúÎßå ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÏäµÎãàÍπå? (ÎÇÆÏùÑÏàòÎ°ù Ï¢ãÏùå)",
                "Í∞Å ÏãúÏä§ÌÖúÏùÑ ÎèÖÎ¶ΩÏ†ÅÏúºÎ°ú Í¥ÄÎ¶¨ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "Ïò®ÌîÑÎ†àÎØ∏Ïä§ÏôÄ ÌÅ¥ÎùºÏö∞Îìú ÏãúÏä§ÌÖúÏóê Î≥¥Ïïà Ìå®ÏπòÎ•º ÏûêÎèôÏúºÎ°ú Ï†ÅÏö©Ìï† Ïàò ÏûàÏäµÎãàÍπå?",
                "Î™®Îì† ÏãúÏä§ÌÖúÏùÑ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î™®ÎãàÌÑ∞ÎßÅÌïòÍ≥† ÏûêÎèô Î≥¥Ïïà ÎåÄÏùëÏù¥ Í∞ÄÎä•Ìï©ÎãàÍπå?"
            ],
            "Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò": [
                "Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Ï†ëÍ∑º Í∂åÌïúÏùÑ ÏàòÎèôÏúºÎ°ú ÏÑ§Ï†ïÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Í∞úÎ∞ú Ïãú Í∏∞Î≥∏Ï†ÅÏù∏ Î≥¥Ïïà ÌÖåÏä§Ìä∏Î•º ÏàòÌñâÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "ÏµúÏÜåÍ∂åÌïú ÏõêÏπôÏúºÎ°ú Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Ï†ëÍ∑ºÏùÑ ÏûêÎèô Ï†úÏñ¥ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "Ïã§ÏãúÍ∞Ñ ÏúÑÌóò Î∂ÑÏÑùÏùÑ ÌÜµÌï¥ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò Ï†ëÍ∑ºÏùÑ ÏûêÎèôÏúºÎ°ú Ï†úÏñ¥Ìï† Ïàò ÏûàÏäµÎãàÍπå?"
            ],
            "Îç∞Ïù¥ÌÑ∞": [
                "Îç∞Ïù¥ÌÑ∞Î•º ÏàòÎèôÏúºÎ°ú Î∂ÑÎ•òÌïòÍ≥† Ï†ëÍ∑ºÍ∂åÌïúÏùÑ ÏÑ§Ï†ïÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "ÏùºÎ∂Ä Ï§ëÏöî Îç∞Ïù¥ÌÑ∞Ïóê ÎåÄÌï¥ ÏûêÎèô Î∂ÑÎ•ò Î∞è Ï†ëÍ∑º Ï†úÏñ¥Í∞Ä Í∞ÄÎä•Ìï©ÎãàÍπå?",
                "ÏµúÏÜåÍ∂åÌïú ÏõêÏπôÏúºÎ°ú Îç∞Ïù¥ÌÑ∞ Ï†ëÍ∑ºÏùÑ ÏûêÎèô Í¥ÄÎ¶¨ÌïòÍ≥† ÏûàÏäµÎãàÍπå?",
                "AIÎ•º Ïù¥Ïö©ÌïòÏó¨ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Îç∞Ïù¥ÌÑ∞Î•º Î∂ÑÎ•òÌïòÍ≥† Ï†ëÍ∑ºÏùÑ Ï†úÏñ¥ÌïòÍ≥† ÏûàÏäµÎãàÍπå?"
            ]
        };

        let currentQuestionIndex = 0;
        let answers = {};
        let totalQuestions = 0;

        // Ï†ÑÏ≤¥ ÏßàÎ¨∏ Ïàò Í≥ÑÏÇ∞
        Object.values(questions).forEach(categoryQuestions => {
            totalQuestions += categoryQuestions.length;
        });

        document.getElementById('startBtn').addEventListener('click', function() {
            // Í∏∞ÏóÖ Ï†ïÎ≥¥ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            const companyName = document.getElementById('companyName').value;
            const email = document.getElementById('email').value;
            const companySize = document.getElementById('companySize').value;
            const businessType = document.getElementById('businessType').value;

            if (!companyName || !email || !companySize || !businessType) {
                showError('Î™®Îì† Í∏∞ÏóÖ Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            // ÏßàÎ¨∏ ÏÑπÏÖò ÌëúÏãú
            document.getElementById('questionsSection').style.display = 'block';
            generateQuestions();
            this.style.display = 'none';
            document.getElementById('submitBtn').classList.remove('hidden');
            updateProgress();
        });

        function generateQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            let questionIndex = 0;

            Object.entries(questions).forEach(([category, categoryQuestions]) => {
                categoryQuestions.forEach((question, index) => {
                    const questionCard = document.createElement('div');
                    questionCard.className = 'question-card';
                    questionCard.innerHTML = `
                        <div class="question-text">
                            <strong>[${category}] ${questionIndex + 1}/${totalQuestions}</strong><br>
                            ${question}
                        </div>
                        <div class="rating-container">
                            <div class="rating-option">
                                <input type="radio" id="q${questionIndex}_1" name="question_${questionIndex}" value="1">
                                <label for="q${questionIndex}_1">1Ï†ê<br>Ï†ÑÌòÄ ÏóÜÏùå</label>
                            </div>
                            <div class="rating-option">
                                <input type="radio" id="q${questionIndex}_2" name="question_${questionIndex}" value="2">
                                <label for="q${questionIndex}_2">2Ï†ê<br>Î∂ÄÎ∂ÑÏ†Å Íµ¨ÌòÑ</label>
                            </div>
                            <div class="rating-option">
                                <input type="radio" id="q${questionIndex}_3" name="question_${questionIndex}" value="3">
                                <label for="q${questionIndex}_3">3Ï†ê<br>ÎåÄÎ∂ÄÎ∂Ñ Íµ¨ÌòÑ</label>
                            </div>
                            <div class="rating-option">
                                <input type="radio" id="q${questionIndex}_4" name="question_${questionIndex}" value="4">
                                <label for="q${questionIndex}_4">4Ï†ê<br>ÏôÑÏ†Ñ Íµ¨ÌòÑ</label>
                            </div>
                        </div>
                    `;
                    container.appendChild(questionCard);
                    questionIndex++;
                });
            });

            // ÎãµÎ≥Ä Î≥ÄÍ≤Ω Ïãú ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
            container.addEventListener('change', updateProgress);
        }

        function updateProgress() {
            const totalInputs = document.querySelectorAll('input[type="radio"]');
            const checkedInputs = document.querySelectorAll('input[type="radio"]:checked');
            const companyInfoFilled = document.getElementById('companyName').value && 
                                    document.getElementById('email').value &&
                                    document.getElementById('companySize').value &&
                                    document.getElementById('businessType').value;

            let progress = 0;
            if (companyInfoFilled) {
                progress = 20 + (checkedInputs.length / totalQuestions * 80);
            } else {
                progress = 0;
            }

            document.getElementById('progressBar').style.width = progress + '%';
            
            if (progress < 20) {
                document.getElementById('progressText').textContent = 'Í∏∞ÏóÖÏ†ïÎ≥¥ ÏûÖÎ†• Ï§ë...';
            } else if (progress < 100) {
                document.getElementById('progressText').textContent = `ÏßÑÎã® ÏßÑÌñâ Ï§ë... (${checkedInputs.length}/${totalQuestions} ÏôÑÎ£å)`;
            } else {
                document.getElementById('progressText').textContent = 'ÏßÑÎã® ÏôÑÎ£å! Í≤∞Í≥º ÌôïÏù∏ÏùÑ ÏúÑÌï¥ "ÏßÑÎã® ÏôÑÎ£å" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.';
            }
        }

        document.getElementById('submitBtn').addEventListener('click', function() {
            // Î™®Îì† ÏßàÎ¨∏ ÏùëÎãµ ÌôïÏù∏
            const checkedInputs = document.querySelectorAll('input[type="radio"]:checked');
            if (checkedInputs.length < totalQuestions) {
                showError(`Î™®Îì† ÏßàÎ¨∏Ïóê ÎãµÎ≥ÄÌï¥Ï£ºÏÑ∏Ïöî. (${checkedInputs.length}/${totalQuestions} ÏôÑÎ£å)`);
                return;
            }

            // ÎãµÎ≥Ä ÏàòÏßë
            collectAnswers();
            
            // Ï†êÏàò Í≥ÑÏÇ∞
            const scores = calculateScores();
            
            // Í≤∞Í≥º ÌëúÏãú
            displayResults(scores);
            
            // ÏÑúÎ≤ÑÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°
            submitToServer(scores);
        });

        function collectAnswers() {
            answers = {};
            let questionIndex = 0;

            Object.keys(questions).forEach(category => {
                answers[category] = [];
                questions[category].forEach(() => {
                    const selectedOption = document.querySelector(`input[name="question_${questionIndex}"]:checked`);
                    answers[category].push(parseInt(selectedOption.value));
                    questionIndex++;
                });
            });
        }

        function calculateScores() {
            const scores = {};
            let totalScore = 0;
            let questionCount = 0;

            Object.entries(answers).forEach(([category, categoryAnswers]) => {
                const categoryScore = categoryAnswers.reduce((sum, score) => sum + score, 0) / categoryAnswers.length;
                scores[category] = Math.round(categoryScore * 10) / 10;
                totalScore += categoryScore;
                questionCount++;
            });

            const overallScore = Math.round((totalScore / questionCount) * 10) / 10;
            const maturityLevel = determineMaturityLevel(overallScore);

            return {
                overall: overallScore,
                maturityLevel: maturityLevel,
                areas: scores
            };
        }

        function determineMaturityLevel(score) {
            if (score <= 1.5) return { level: 1, name: "Í∏∞Ï°¥(Traditional)" };
            if (score <= 2.5) return { level: 2, name: "Ï¥àÍ∏∞(Initial)" };
            if (score <= 3.5) return { level: 3, name: "Ìñ•ÏÉÅ(Advanced)" };
            return { level: 4, name: "ÏµúÏ†ÅÌôî(Optimal)" };
        }

        function displayResults(scores) {
            document.getElementById('overallScore').textContent = scores.overall.toFixed(1);
            document.getElementById('maturityLevel').textContent = `Level ${scores.maturityLevel.level} - ${scores.maturityLevel.name}`;

            // ÏòÅÏó≠Î≥Ñ Ï†êÏàò ÌëúÏãú
            const areaScoresContainer = document.getElementById('areaScores');
            areaScoresContainer.innerHTML = '';

            Object.entries(scores.areas).forEach(([area, score]) => {
                const areaCard = document.createElement('div');
                areaCard.className = 'area-score-card';
                areaCard.innerHTML = `
                    <h3>${area}</h3>
                    <div class="area-score-value">${score.toFixed(1)}</div>
                `;
                areaScoresContainer.appendChild(areaCard);
            });

            // Î†àÏù¥Îçî Ï∞®Ìä∏ ÏÉùÏÑ±
            createRadarChart(scores.areas);

            // Í≤∞Í≥º ÏòÅÏó≠ ÌëúÏãú
            document.getElementById('resultsContainer').style.display = 'block';
            
            // Í≤∞Í≥º ÏòÅÏó≠ÏúºÎ°ú Ïä§ÌÅ¨Î°§
            document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
        }

        function createRadarChart(areaScores) {
            const areas = Object.keys(areaScores);
            const scores = Object.values(areaScores);

            const data = [{
                type: 'scatterpolar',
                r: scores,
                theta: areas,
                fill: 'toself',
                fillcolor: 'rgba(52, 152, 219, 0.3)',
                line: {
                    color: 'rgb(52, 152, 219)',
                    width: 3
                },
                marker: {
                    color: 'rgb(52, 152, 219)',
                    size: 8
                },
                name: 'ÌòÑÏû¨ Ï†êÏàò'
            }];

            const layout = {
                polar: {
                    radialaxis: {
                        visible: true,
                        range: [0, 4],
                        tickfont: { size: 12 },
                        gridcolor: '#E8E8E8'
                    },
                    angularaxis: {
                        tickfont: { size: 14 }
                    }
                },
                showlegend: false,
                title: {
                    text: 'ÏòÅÏó≠Î≥Ñ Î≥¥Ïïà ÏÑ±ÏàôÎèÑ',
                    font: { size: 18, color: '#2c3e50' }
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            Plotly.newPlot('radarChart', data, layout, {responsive: true});
        }

        function submitToServer(scores) {
            document.getElementById('loadingMessage').style.display = 'block';

            const formData = {
                companyName: document.getElementById('companyName').value,
                email: document.getElementById('email').value,
                companySize: document.getElementById('companySize').value,
                businessType: document.getElementById('businessType').value,
                overallScore: scores.overall,
                maturityLevel: scores.maturityLevel.level,
                identityScore: scores.areas['Ïã†Ïõê'] || 0,
                deviceScore: scores.areas['Í∏∞Í∏∞ Î∞è ÏóîÎìúÌè¨Ïù∏Ìä∏'] || 0,
                networkScore: scores.areas['ÎÑ§Ìä∏ÏõåÌÅ¨'] || 0,
                systemScore: scores.areas['ÏãúÏä§ÌÖú'] || 0,
                applicationScore: scores.areas['Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖò'] || 0,
                dataScore: scores.areas['Îç∞Ïù¥ÌÑ∞'] || 0,
                allAnswers: answers
            };

            fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('loadingMessage').style.display = 'none';
                
                if (data.success) {
                    showSuccess('ÏßÑÎã® Í≤∞Í≥ºÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
                } else {
                    showError('Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + data.message);
                }
            })
            .catch(error => {
                document.getElementById('loadingMessage').style.display = 'none';
                console.error('Error:', error);
                showError('ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
            });
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 5000);
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏßÑÌñâÎ•† Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            
            // Í∏∞ÏóÖ Ï†ïÎ≥¥ ÏûÖÎ†• Ïãú ÏßÑÌñâÎ•† ÏóÖÎç∞Ïù¥Ìä∏
            ['companyName', 'email', 'companySize', 'businessType'].forEach(id => {
                document.getElementById(id).addEventListener('change', updateProgress);
            });
        });
    </script>
</body>
</html>
